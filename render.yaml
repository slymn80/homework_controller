services:
  - type: web
    name: homework-controller-api
    env: docker
    plan: starter
    autoDeploy: true
    healthCheckPath: /health
    disk:
      name: outputs-disk
      mountPath: /app/outputs
      sizeGB: 1
    envVars:
      - key: OPENAI_API_KEY
        sync: false
      - key: GOOGLE_SERVICE_ACCOUNT_JSON
        value: creds/service_account.json
      - key: ALLOWED_EXT
        value: .txt,.docx,.pdf,.jpg,.jpeg,.png
      - key: OCR_LANG
        value: tur+eng
      - key: LOCAL_OUTPUT_DIR
        value: outputs
      - key: REPORT_PREFIX
        value: grading-report
      - key: MAX_FILES_PER_RUN
        value: "0"

  # ðŸš€ Cron Job yerine ek bir worker servisi kullan
  - type: cron
    name: homework-controller-daily
    env: docker
    schedule: "0 12 * * *"   # UTC 12 = Asia/Almaty 18:00
    command: "python -m src.main"
